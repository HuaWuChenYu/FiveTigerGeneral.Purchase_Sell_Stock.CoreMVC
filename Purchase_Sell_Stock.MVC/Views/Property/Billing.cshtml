
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <script src="~/layui/layui.js"></script>
    <link href="~/layui/css/layui.css" rel="stylesheet" />
    <title>Billing</title>
</head>
<body>
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
        <legend>五虎盛世集团、综合账单、对账详细复杂组合响应式展现</legend>
    </fieldset>

    <div style="margin-top:30px;margin-right:40px">

        <div style="margin-left:20px">
            <form class="layui-form" action="">

                类型：
                <div class="layui-inline">
                    <select name="Account_Type" id="Account_Type" lay-verify="">
                        <option value=" ">请选择</option>
                        <option value="店铺余额">店铺余额</option>
                        <option value="店铺收益">店铺收益</option>
                    </select>
                </div>

                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;单据类型：
                <div class="layui-inline">
                    <select name="Order_type" id="Order_type" lay-verify="">
                        <option value=" ">请选择</option>
                        <option value="充值">充值</option>
                        <option value="提现">提现</option>
                        <option value="订单完结">订单完结</option>
                        <option value="采购支出">采购支出</option>
                    </select>
                </div>

                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;单据编码：
                <div class="layui-inline">

                    <input class="layui-input" name="Order_NUm" id="Order_NUm" autocomplete="off">
                </div>

                &nbsp;&nbsp; &nbsp;&nbsp;入账时间范围：
                <div class="layui-inline">
                    <div class="layui-input-inline">
                        <input type="text" id="start_time" name="start_time" autocomplete="off" placeholder="请输入开始时间" class="layui-input">
                    </div>
                    至
                    <div class="layui-input-inline">
                        <input type="text" id="end_time" name="end_time" autocomplete="off" placeholder="请输入结束时间" class="layui-input">
                    </div>

                </div>

                &nbsp;&nbsp; &nbsp;&nbsp;支/收
                <div class="layui-inline">
                    <select name="InorOut" id="InorOut" lay-verify="">
                        <option value=" ">请选择</option>
                        <option value="1">收入</option>
                        <option value="0">支出</option>

                    </select>
                </div>

                &nbsp;&nbsp; &nbsp;
                <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>



            </form>
            <table id="test" class="layui-table" lay-even lay-skin="nob" lay-size="sm"></table>
        </div>


    </div>


</body>
</html>
<script>
    layui.use(['table', 'laydate', 'form'], function () {
        var table = layui.table,
            $ = layui.$;
        var form = layui.form;
        var laydate = layui.laydate;
        var endDate = laydate.render({
            elem: '#end_time',//选择器结束时间
            type: 'datetime',
            min: "1970-1-1",//设置min默认最小值
            done: function (value, date) {
                startDate.config.max = {
                    year: date.year,
                    month: date.month - 1,//关键
                    date: date.date,

                }
            }
        });
        //日期范围
        var startDate = laydate.render({
            elem: '#start_time',
            type: 'datetime',
            max: "2099-12-31",//设置一个默认最大值
            done: function (value, date) {
                endDate.config.min = {
                    year: date.year,
                    month: date.month - 1, //关键
                    date: date.date,

                };
            }
        });
        table.render({
            elem: '#test'
            , url: 'http://localhost:49760/api/ShowBilling_details'
            , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
            , cols: [[
                { field: 'date_recorded', width: 180, title: '入账时间', sort: true }
                , { field: 'Account_Type', width: 180, title: '类型' }
                , { field: 'Account_Money', width: 120, title: '金额', sort: true }
                , { field: 'Balance_Money', width: 80, title: '余额'}
                , {
                    field: 'InorOut', width: 180, title: '收入/支出',
                    templet: function (d) {
                        if (d.gender == 1) { return '收入' } else { return '支出' }
                    }
                }
                , { field: 'Order_type', title: '单据类型', minWidth: 100 } //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , { field: 'Order_NUm', title: '单据编码' }
            ]]
            , limits: [5, 10, 30]
            , limit: 10
            , request: {
                pageName: 'pageIndex',//控制器 显示方法 当前页数参数
                limitName: 'pageSize' //控制器 显示方法 每页条数参数
            }
            , id: 'testReload'
            , page: true
        });

        //监听提交
        form.on('submit(formDemo)', function (data) {
            alert(data.field.start_time);
            //执行重载
            table.reload('testReload', {
                page: {
                    curr: 1 //重新从第 1 页开始
                }
                , where: {
                    Account_Type: data.field.Account_Type,
                    Order_type: data.field.Order_type,
                    Order_NUm: data.field.Order_NUm,
                    statrtime: data.field.start_time,
                    endtime: data.field.end_time,
                    InorOut: data.field.InorOut,
                }
            }, 'data');
            return false;
        });

    });




</script>