
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Test</title>
    <script src="~/layui/layui.js"></script>
    <link href="~/layui/css/layui.css" rel="stylesheet" />
    <link href="~/css/css/bootstrap.css" rel="stylesheet" />
</head>
<body>
    <div style="float:left;width:340px;margin-left:10px;margin-top:10px">
        <div class="layui-input-inline" style="margin-left:10px;margin-top:10px">
            <input type="text" name="title" lay-verify="title" autocomplete="off" placeholder="请输入角色名称" class="layui-input">
            <div id="test13" style="font-size:20px" class="demo-tree-more"></div>
        </div>
    </div>
    <div style="float:left;width:850px;margin-left:20px;margin-top:10px">
        <table id="setPower" class="table table-bordered">
            <tr>
                <td>主菜单</td>
                <td>页面主菜单</td>
                <td>页面副菜单</td>
            </tr>
        </table>
    </div>
    <table width="100%" border="1">
        <tr>
            <td rowspan="7">hhh1</td>
            <td rowspan="3">hhh5</td>
            <td>hhh5</td>
        </tr>
        <tr>
            <td>hhh5</td>
        </tr>
        <tr>
            <td>hhh5</td>
        </tr>
        <tr>
            <td rowspan="3">hhh5</td>
            <td>hhh5</td>
        </tr>
        <tr>
            <td>hhh5</td>
        </tr>
        <tr>
            <td>hhh5</td>
        </tr>
        <tr>
            <td>hhh5</td>
            <td>hhh5</td>
        </tr>
    </table>
</body>
</html>
<script>
    layui.use(['tree', 'util'], function () {
        var tree = layui.tree
            , layer = layui.layer
            , util = layui.util
            , $ = layui.$;
        //模拟数据1
        var rowspan1=0;
        var rowspan2=0;
        var rowspan3=0;
        var data;
        $.ajax({
            url: "http://localhost:49760/api/Setting/GetRoleTypes",
            contentType: "application/json",
            async: false,
            success: function (d) {
                data = d;
            }
        });
        $.ajax({
            url: "http://localhost:49760/api/Setting/GetPowersBySet?powerParentId=0&rolesId=1",
            contentType: "application/json",
            async: false,
            success: function (d) {
                $(d).each(function () {
                    var trid = 'trid' + this.powersId;
                    var str = '<tr id="' + trid + '">'
                        + '<td>' + this.powersName + '</td>'
                        + '</tr>';
                    $("#setPower").append(str);
                    $.ajax({
                        url: "http://localhost:49760/api/Setting/GetPowersBySet?powerParentId=" + this.powersId+"&rolesId=1",
                        contentType: "application/json",
                        async: false,
                        success: function (d2) {
                            $(d2).each(function () {
                                var str2 = '<td>' + this.powersName + '</td>';
                                $("#" + trid).append(str2);
                                $.ajax({
                                    url: "http://localhost:49760/api/Setting/GetPowersBySet?powerParentId=" + this.powersId + "&rolesId=1",
                                    contentType: "application/json",
                                    async: false,
                                    success: function (d3) {
                                        $(d3).each(function () {
                                            var str3 = '<td>' + this.powersName+'</td>';
                                            $("#" + trid).append(str3);
                                        })
                                    }
                                });
                            })
                            
                        }
                    });
                });
                
            }
        });
        
        //无连接线风格
        tree.render({
            elem: '#test13'
            , data: data
            , showLine: false  //是否开启连接线
        });

    });
</script>